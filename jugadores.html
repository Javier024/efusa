<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Jugadores - EFUSA</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    form input {
      margin: 5px;
      padding: 8px;
    }

    button {
      padding: 8px 15px;
      cursor: pointer;
    }

    table {
      margin-top: 20px;
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }

    th {
      background: #f2f2f2;
    }
  </style>
</head>
<body>

<h1>Listado de Jugadores</h1>

<h2>➕ Registrar jugador</h2>

<form id="formJugador">
  <input id="nombre" placeholder="Nombre" required>
  <input id="categoria" placeholder="Categoría" required>
  <input id="mensualidad" type="number" placeholder="Mensualidad" required>
  <input id="acudiente" placeholder="Nombre acudiente" required>
  <input id="telefono" placeholder="Teléfono" required>
  <input id="direccion" placeholder="Dirección" required>
  <input id="sangre" placeholder="Tipo de sangre" required>
  <button type="submit">Guardar</button>
</form>

<h2>Jugadores registrados</h2>

<table>
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Categoría</th>
      <th>Mensualidad</th>
      <th>Acudiente</th>
      <th>Teléfono</th>
      <th>Estado</th>
    </tr>
  </thead>
  <tbody id="tablaJugadores"></tbody>
</table>

<script>
async function cargarJugadores() {
  try {
    const res = await fetch('/api/jugadores');
    const jugadores = await res.json();

    const tabla = document.getElementById('tablaJugadores');
    tabla.innerHTML = '';

    jugadores.forEach(j => {
      tabla.innerHTML += `
        <tr>
          <td>${j.nombre}</td>
          <td>${j.categoria}</td>
          <td>$${j.mensualidad}</td>
          <td>${j.nombre_acudiente}</td>
          <td>${j.telefono}</td>
          <td>${j.activo ? 'Activo' : 'Inactivo'}</td>
        </tr>
      `;
    });

  } catch (error) {
    console.error(error);
    alert('Error al cargar jugadores');
  }
}

document.getElementById('formJugador').addEventListener('submit', async (e) => {
  e.preventDefault();

  const data = {
    nombre: nombre.value,
    categoria: categoria.value,
    mensualidad: mensualidad.value,
    nombre_acudiente: acudiente.value,
    telefono: telefono.value,
    direccion: direccion.value,
    tipo_sangre: sangre.value
  };

  const res = await fetch('/api/jugadores', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  });

  if (res.ok) {
    alert('Jugador registrado');
    e.target.reset();
    cargarJugadores();
  } else {
    alert('Error al registrar');
  }
});

cargarJugadores();
</script>

</body>
</html>
